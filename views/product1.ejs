<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="/product.css" />

    <title>product</title>
  </head>
  <body>
    <div style="background-color: black; height: 4px" class="w-100"></div>
    <div id="menuHolder">
      <div
        role="navigation"
        class="sticky-top border-bottom border-top"
        id="mainNavigation"
      >
        <div class="flexMain">
          <div class="flex2"></div>
          <div
            class="flex3 text-center m-4"
            id="siteBrand"
            style="font-size: 52px; margin-left: 200px; padding-top: 22px"
          >
            AROMA
          </div>

          <div class="flex2 text-end d-block d-md-none">
            <button class="whiteLink siteLink">
              <i class="fas fa-search"></i>
            </button>
          </div>

          <div class="flex2 text-end d-none d-md-block align-content-lg-end">
            <div class="d-flex justify-content-end align-items-center pr-5">
              <div class="icon-box">
                <a href=""
                  ><i
                    ><svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="17"
                      height="17"
                      style="color: black"
                      fill="currentColor"
                      class="bi bi-search"
                      viewBox="0 0 16 16"
                    >
                      <path
                        d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"
                      /></svg></i
                ></a>
              </div>
              <div class="icon-box">
                <a href="profile"
                  ><i
                    ><svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="16"
                      height="16"
                      fill="currentColor"
                      class="bi bi-person-circle"
                      viewBox="0 0 16 16"
                    >
                      <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z" />
                      <path
                        fill-rule="evenodd"
                        d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"
                      /></svg></i
                ></a>
              </div>

              <div class="icon-box">
                <a href="cart"
                  ><i
                    ><svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="16"
                      height="16"
                      fill="currentColor"
                      class="bi bi-cart3"
                      viewBox="0 0 16 16"
                    >
                      <path
                        d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .49.598l-1 5a.5.5 0 0 1-.465.401l-9.397.472L4.415 11H13a.5.5 0 0 1 0 1H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5zM3.102 4l.84 4.479 9.144-.459L13.89 4H3.102zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4zm-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2zm7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"
                      /></svg></i
                ></a>
              </div>
            </div>
          </div>
        </div>
        <div
          class="d-flex justify-content-center"
          style="
            /* align-items: center; */
            text-align: center;
            font-size: medium;
            font-size: 15px;
            padding-top: 0;
          "
        >
          <p class="p-3 mt-3"><a href="home">HOME</a></p>
          <% categorydata.forEach(category => { %>
          <p class="p-3 mt-3"><%=category.name%></p>
          <% })%>
          <p class="p-3 mt-3">SHOP</p>
          <p class="p-3 mt-3">HELP</p>
        </div>
      </div>
    </div>
    <div class="product-containe d-flex">
      <!-- ... (your existing HTML code) ... -->

      <div class="product-image col-lg-6 col-md-6 col-sm-12 pt-5">
        <div
          id="productImageCarousel"
          class="carousel slide"
          style="color: black"
          data-ride="carousel"
        >
          <div class="carousel-inner">
            <% if (Array.isArray(products.image) && products.image.length > 0) {
            %> <% products.image.forEach((image, index) => { %>
            <div class="carousel-item <%= index === 0 ? ' active' : '' %>">
              <img
                src="<%= image %>"
                class="d-block w-100"
                alt="<%= products.name %>"
                data-toggle="modal"
                data-target="#imageZoomModal<%= index + 1 %>"
              />
            </div>
            <% }); %> <% } %>
          </div>
          <% if (Array.isArray(products.image) && products.image.length > 1) {
          %>
          <a
            class="carousel-control-prev"
            href="#productImageCarousel"
            role="button"
            data-slide="prev"
          >
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
          </a>
          <a
            class="carousel-control-next"
            href="#productImageCarousel"
            role="button"
            data-slide="next"
          >
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
          <% } %>
        </div>
      </div>

      <!-- ... (your existing HTML code) ... -->

      <div class="product-details col-lg-6 col-md-6 col-sm-12">
        <h1 class="product-title" style="font-size: 30px">
          <%= products.name %>
        </h1>
        <hr class="first-hr" />
        <p
          class="product-description m-0 p-0"
          style="font-size: 23px; font-weight: 300"
        >
          <%= products.description %>
        </p>
        <a href=""
          ><p
            class="product-price m-0 pt-0 pb-4"
            style="font-size: 15px; font-weight: 100"
          >
            view more detials
          </p></a
        >
        <div class="d-flex">
          <p class="product-price" id="productPrice">
            &#8377;<%= products.price %>
          </p>
          <button class="fav-btn btn" style="padding-left: 290px">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              fill="currentColor"
              class="bi bi-heart"
              viewBox="0 0 16 16"
            >
              <path
                d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"
              />
            </svg>
          </button>
        </div>

        <hr />

        <p style="font-size: 14px; font-weight: 600">
          <%=products.size.length%> SIZE AVAILABLE
        </p>
        <div class="btn-block">
          <button
            type="button"
            style="
              border-color: rgb(48, 54, 54);
              margin-top: 12px;
              width: 380px;
              font-family: tahoma;
              font-size: 15px;
            "
            class="btn dropdown-toggle"
            data-toggle="dropdown"
            aria-expanded="false"
            id="dropdownButton"
            onchange="updatePrice()"
          >
            <%= products.size[0].quantity%>ml
          </button>
          <ul class="dropdown-menu">
            <% products.size.forEach((variant) => { %>
            <li>
              <a
                class="dropdown-item"
                href="#"
                data-variant-id="<%= variant.quantity %>"
                ><%= variant.quantity %>ml</a
              >
            </li>

            <% }); %>
          </ul>
        </div>
        <button class="add-to-cart-btn">
          <a class="add-to-cart-btn" id="addToCartButton">ADD TO CART</a>
        </button>
      </div>
    </div>

    <div class="product-info-box text-center">
      <h3 class="product-info-title">PRODUCT INFORMATION</h3>
      <hr />
      <h6>PRODUCT DETAILS</h6>
      <P style="color: rgb(149, 149, 149)"> <%= products.description %> </P>
      <hr />
      <H6>ADDITIONAL INFORMATION</H6>
      <P style="color: rgb(149, 149, 149)"> <%= products.specification %> </P>
      <hr />
    </div>
    <h1 class="text-center pt-5">PERFECT MATCH</h1>
    <div
      class="container product-container align-content-center justify-content-center"
    >
      <!-- Added a container for the product grid -->
      <div
        class="row align-content-center justify-content-center product-details-middle"
      >
        <% related.forEach(product => { %>
        <a href="/products?id=<%=product._id%>">
          <div class="col col-size">
            <!-- Create a column for each product -->
            <div
              class="product-box align-content-center justify-content-center"
            >
              <img
                src="<%= product.image[0] %>"
                alt="Product Name"
                width="200"
                height="200"
              />
              <div class="product-details-middle">
                <h4 class="product-title text-decoration-none">
                  <%= product.name%>
                </h4>

                <p class="product-description"><%= product.description %></p>
                <p class="product-price">&#8377;<%= product.price %></p>
                <a class="add-to-cart">View details</a>
              </div>
            </div>
          </div>
        </a>
        <!-- Start of the product grid row -->

        <% }); %>
      </div>
    </div>
    <div class="footer-head">
      <footer>
        <h4 class="text-center p-5" style="font-family: lucida">AROMA</h4>
        <div class="row-style">
          <div class="col-style" style="color: rgb(160, 160, 160)">
            <p style="font-size: 11px; color: rgb(255, 255, 255)">
              EXPLORE AROMA.COM
            </p>
            <p style="font-size: 11px">WOMEN</p>
            <p style="font-size: 11px">MEN</p>
            <p style="font-size: 11px">SHOP</p>
          </div>
          <div class="col-style" style="color: rgb(160, 160, 160)">
            <p style="font-size: 11px; color: rgb(255, 255, 255)">
              ONLINE SERVICES
            </p>
            <p style="font-size: 11px">MY ACCOUNT</p>
            <p style="font-size: 11px">HELP</p>
            <p style="font-size: 11px">MY CART</p>
            <p style="font-size: 11px">MY WHISHLIST</p>
          </div>
        </div>
      </footer>
    </div>
    <script>
      // for drop down text placement
      var dropdownButton = document.getElementById("dropdownButton");
      var dropdownItems = document.querySelectorAll(".dropdown-item");
      dropdownItems.forEach(function (item) {
        item.addEventListener("click", function () {
          dropdownButton.textContent = item.textContent;
        });
      });
    </script>
    <!-- Bootstrap JavaScript and jQuery -->

    <script
      src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
      integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"
      integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
      crossorigin="anonymous"
    ></script>

    <script
      src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
      integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"
      integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
      crossorigin="anonymous"
    ></script>

    <div>
      <% if (Array.isArray(products.image) && products.image.length > 0) { %> <%
      products.image.forEach((image, index) => { %>
      <!-- Modal for zoomed image -->
      <div
        class="modal fade"
        id="imageZoomModal<%= index + 1 %>"
        tabindex="-1"
        role="dialog"
        aria-labelledby="imageZoomModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-dialog-centered modal-lg">
          <div class="modal-content">
            <div class="modal-body">
              <img
                src="<%= products.image[index]%>"
                alt="Zoomed Image"
                width="100%"
                height="100%"
                class="zoomed-image"
                id="zoomedImage"
              />
            </div>
          </div>
        </div>
      </div>
      <% }); %> <% } %>
    </div>
    <script>
      document
        .getElementById("addToCartButton")
        .addEventListener("click", function (event) {
          event.preventDefault(); // Prevent the default form submission behavior
          alert("cart button clicked");
          console.log("function started for add to cart");
          // Fetch product ID and other necessary data
          var productId = "<%-products._id %>"; // Update with the correct way to get product ID

          console.log(productId, "productid");
          // Create an object to send in the request
          var requestData = {
            key: productId,
          };
          // console.log("this function is working");

          // Send a POST request to the server using AJAX
          // console.log("Before fetch");
          // alert(JSON.stringify(requestData));

          // fetch("/cart1", {
          //   method: "POST",
          //   body: JSON.stringify({
          //     key: productId,
          //   }),
          // })
          //   .then(function (response) {
          //     if (response.ok) {
          //       return response.json();
          //     } else {
          //       alert(JSON.stringify(response));
          //       throw new Error(
          //         "Failed to add item to the cart",
          //         response.status
          //       );
          //     }
          //   })
          //   .then(function (data) {
          //     // Handle the success response
          //     alert(data); // You can replace this with a more user-friendly notification
          //   })
          //   .catch(function (error) {
          //     console.log(error);
          //     alert(`Erro = >  ${error}`);
          //   });
          fetch(`/add-to-cart?productId=${requestData.key}`).then(response=>response.json()).then(res=>{
            // alert('fetch came')
          })
        });
    </script>
  </body>
</html>
