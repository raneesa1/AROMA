<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css"
      integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="/addproduct.css" />

    <title>Add Product</title>
  </head>
  <body>
    <div style="background-color: black; height: 4px" class="w-100"></div>

    <div id="menuHolder">
      <div
        role="navigation"
        class="sticky-top border-bottom border-top"
        id="mainNavigation"
      >
        <div class="flexMain">
          <div class="flex2"></div>
          <div
            class="flex3"
            id="siteBrand"
            style="font-size: 52px; margin-bottom: 0px; padding-bottom: 0"
          >
            AROMA
          </div>

          <div class="flex2 text-end d-block d-md-none">
            <button class="whiteLink siteLink">
              <i class="fas fa-search"></i>
            </button>
          </div>

          <div class="flex2 text-end d-none d-md-block align-content-lg-end">
            <div class="d-flex justify-content-end align-items-center pr-5">
              <div class="icon-box">
                <a href=""
                  ><i
                    ><svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="17"
                      height="17"
                      style="color: black"
                      fill="currentColor"
                      class="bi bi-search"
                      viewBox="0 0 16 16"
                    >
                      <path
                        d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"
                      /></svg></i
                ></a>
              </div>

              <div class="icon-box">
                <a href=""
                  ><i
                    ><svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="16"
                      height="16"
                      fill="currentColor"
                      class="bi bi-person-circle"
                      viewBox="0 0 16 16"
                    >
                      <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z" />
                      <path
                        fill-rule="evenodd"
                        d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"
                      /></svg></i
                ></a>
              </div>
              <div class="icon-box">
                <a href=""
                  ><i
                    ><svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="17"
                      height="17"
                      style="color: rgb(0, 0, 0)"
                      fill="currentColor"
                      class="bi bi-heart"
                      viewBox="0 0 16 16"
                    >
                      <path
                        d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.920 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z"
                      /></svg></i
                ></a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <section>
      <!-- <div class="d-flex"> -->
      <div>
        <div class="box-container">
          <div class="box">
            <div class="row">
              <div class="col-lg-6 mx-auto m-4">
                <div class="card">
                  <div
                    class="card-header text-center"
                    style="background-color: rgb(0, 0, 0); color: aliceblue"
                  >
                    <h5>ADD NEW PRODUCT</h5>
                  </div>
                  <div class="card-body">
                    <form
                      action="/admin/addproduct"
                      method="post"
                      id="add-form"
                      enctype="multipart/form-data"
                    >
                      <div class="mb-3">
                        <label for="name">Name</label>
                        <input
                          type="text"
                          name="name"
                          id="name"
                          class="form-control form-control-lg"
                          placeholder="Enter product name"
                        />
                        <% if(err){ %>

                        <small
                          id="errorMessage"
                          style="color: red; margin-top: 10px"
                        >
                          <%=err%>
                        </small>
                        <%}%>
                        <small id="nameError" class="text-danger"></small>
                      </div>
                      <div class="mb-3">
                        <div id="selectedImages" class="mb-3">
                          <img
                            src=""
                            id="displayimages0"
                            alt=""
                            style="max-width: 100px; max-height: 100px"
                            class="img-thumbnail"
                          />
                          <img
                            id="displayimages1"
                            src=""
                            alt=""
                            style="max-width: 100px; max-height: 100px"
                            class="img-thumbnail"
                          />
                          <img
                            id="displayimages2"
                            src=""
                            alt=""
                            style="max-width: 100px; max-height: 100px"
                            class="img-thumbnail"
                          />
                          <img
                            id="displayimages3"
                            src=""
                            alt=""
                            style="max-width: 100px; max-height: 100px"
                            class="img-thumbnail"
                          />
                          <img
                            id="displayimages4"
                            src=""
                            alt=""
                            style="max-width: 100px; max-height: 100px"
                            class="img-thumbnail"
                          />
                        </div>
                        <label for="images">Images</label>

                        <input
                          id="displayinput"
                          onchange="displayImages('displayinput','selectedImages')"
                          type="file"
                          name="images"
                          class="form-control-file"
                          multiple
                        />

                        <small id="imagesError" class="text-danger"></small>
                      </div>
                      <div class="mb-3">
                        <label for="description">Description</label>
                        <textarea
                          name="description"
                          id="desciption"
                          class="form-control form-control-lg"
                          placeholder="Enter product description"
                        ></textarea>
                        <small id="desciptionError" class="text-danger"></small>
                      </div>
                      <div class="mb-3">
                        <label for="description">Additional Information</label>
                        <textarea
                          name="specification"
                          id="additionalinfo"
                          class="form-control form-control-lg"
                          placeholder="Enter Additional Information"
                        ></textarea>
                        <small
                          id="additionalinfoError"
                          class="text-danger"
                        ></small>
                      </div>
                      <div class="mb-3">
                        <label for="category">Category</label>
                        <select
                          name="category"
                          class="form-control form-control-lg"
                        >
                          <% categorydata.forEach((category)=>{ %>
                          <option value="<%-category._id%>">
                            <%-category.name%>
                          </option>
                          <%})%>
                        </select>
                      </div>

                      <div class="mb-5">
                        <label for="price">Price</label>
                        <input
                          type="number"
                          name="price"
                          id="price"
                          class="form-control form-control-lg"
                          placeholder="Enter product price"
                        />
                        <small id="priceError" class="text-danger"></small>
                      </div>
                      <!-- <hr /> -->

                      <div class="mb-5">
                        <label for="price">Stock</label>
                        <input
                          type="number"
                          name="stock"
                          id="stock"
                          class="form-control form-control-lg"
                          placeholder="Enter the product stock"
                        />
                        <small id="stockError" class="text-danger"></small>
                      </div>
                      <input
                        style="
                          background-color: rgb(0, 0, 0);
                          border-color: rgb(0, 0, 0);
                          font-size: 12px;
                        "
                        type="submit"
                        name="submit"
                        value="Add Product"
                        class="btn btn-primary btn-lg mt-5 btn-block"
                      />
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- </div> -->
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->

    <script>
      document
        .getElementById("add-form")
        .addEventListener("submit", function (event) {
          function isEmpty(value) {
            const trimmedValue = value.trim();
            return trimmedValue === "";
          }

          const name = document.getElementById("name");
          const namenameValue = name.value;
          const nameError = document.getElementById("nameError");

          const desciption = document.getElementById("desciption");
          const desciptionValue = desciption.value;
          const desciptionError = document.getElementById("desciptionError");

          const additionalinfo = document.getElementById("additionalinfo");
          const additionalinfoValue = additionalinfo.value;
          const additionalinfoError = document.getElementById(
            "additionalinfoError"
          );

          const price = document.getElementById("price");
          const priceValue = parseFloat(price.value);
          const priceError = document.getElementById("priceError");

          const stock = document.getElementById("stock");
          const stockValue = parseInt(stock.value, 10);
          const stockError = document.getElementById("stockError");

          const images = document.getElementById("displayinput");
          const imagesError = document.getElementById("imagesError");

          nameError.textContent = "";
          desciptionError.textContent = "";
          additionalinfoError.textContent = "";
          priceError.textContent = "";
          stockError.textContent = "";
          imagesError.textContent = "";

          if (images.files.length === 0) {
            imagesError.textContent = "Please select at least one image";
            event.preventDefault();
          }

          if (isEmpty(namenameValue)) {
            nameError.textContent = "name can't be empty";
            event.preventDefault();
          }

          if (isEmpty(desciptionValue)) {
            desciptionError.textContent = "Desciption can't be empty";
            event.preventDefault();
          }
          if (isEmpty(additionalinfoValue)) {
            additionalinfoError.textContent =
              "Additional information can't be empty";
            event.preventDefault();
          }
          if (isNaN(priceValue) || priceValue <= 0) {
            priceError.textContent = "Price must be a valid number";
            event.preventDefault();
          }

          if (isNaN(stockValue) || stockValue <= 0) {
            stockError.textContent =
              "Stock must be a positive integer greater than 0";
            event.preventDefault();
          }
          if (desciptionValue.length > 45) {
            desciptionError.textContent =
              "Description must not exceed 45 characters";
            event.preventDefault();
          }
          if (additionalinfoValue.length < 60) {
            additionalinfoError.textContent =
              "Additional information must be at least 60 characters";
            event.preventDefault();
          }
        });
    </script>
    <script>
      function displayImages(inputId, outputId) {
        var input = document.getElementById(inputId);
        var output = document.getElementById(outputId);
        output.innerHTML = ""; // Clear previous images

        if (input.files) {
          for (var i = 0; i < input.files.length; i++) {
            var img = document.createElement("img");
            img.src = URL.createObjectURL(input.files[i]);
            img.alt = "";
            img.style.maxWidth = "100px";
            img.style.maxHeight = "100px";
            img.classList.add("img-thumbnail");
            output.appendChild(img);
          }
        }
      }
    </script>

    <script
      src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
      integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
      integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
      integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
      crossorigin="anonymous"
    ></script>
    <!-- Add this script at the end of your HTML body -->
  </body>
</html>
